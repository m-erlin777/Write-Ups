## Events and Alerts

**From Events to Alerts**
First, an event must occur, like user login, process launch, or file download. Then, the system, like your OS, a firewall, or a cloud provider must log the event. After that, all system logs must be shipped to a security solution like SIEM or EDR. The SOC team can receive millions of logs per day from thousands of different systems, where most of the events are expected, but some require attention.Â **Alert**, a notification generated by a security solution when a specific event or sequence of events occurs, is what saves SOC analysts from manual log review by highlighting only suspicious, anomalous events. With alerts, analysts triage just dozens of alerts per day instead of millions of raw logs.

**Alert Management Platforms**

| Solution         | Examples                      | Description                                                                                                                                                                       |
| ---------------- | ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SIEM  <br>System | Splunk ES,Â   <br>Elastic      | SIEM have solid alert management capabilities and are a perfect choice for most SOC teams                                                                                         |
| EDR or  <br>NDR  | MS Defender,  <br>CrowdStrike | While EDR and NDR provide their own alert dashboards, it is preferred to use SIEM or SOAR                                                                                         |
| SOAR  <br>System | Splunk SOAR,  <br>Cortex SOAR | Bigger SOC teams can use SOAR to aggregate and centralise alerts from multiple solutions                                                                                          |
| ITSM  <br>System | Jira,  <br>TheHive            | Some teams may have a custom ticket management (ITSM) setup using a dedicated solution  <br>(The GIF above is taken from Trello, a simple tool that can be adapted to ITSM needs) |

**L1 Role in Alert Triage**
SOC L1 analysts are the first line of defence, and they are the ones who work with alerts the most. Depending on various factors, L1 analysts may receive zero to a hundred alerts a day, every one of which can reveal a cyberattack. Still, everyone in the SOC team is somehow involved in the alert triage:

- **SOC L1 analysts:**Â  Review the alerts, distinguish bad from good, and notify L2 analysts in case of a real threat
- **SOC L2 analysts:**Â  Receive the alerts escalated by L1 analysts and perform deeper analysis and remediation
- **SOC engineers:**Â  Ensure the alerts contain enough information required for efficient alert triage
- **SOC manager:**Â  Track speed and quality of alert triage to ensure that real attacks won't be missed

Questions:
```
What is the number of alerts you see in the SOC dashboard?
5

What is the name of the most recent alert you see?
Double-Extension File Creation
```

<img width="1517" height="710" alt="ss1" src="https://github.com/user-attachments/assets/75b70d18-d8c8-4881-aab9-bf94ed2c9baf" />


## Alert Properties

| â„–     | Property          | Description                                                                                                                | Examples                                                                                                                         |
| ----- | ----------------- | -------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| **1** | Alert Time        | Shows alert creation time. Alert usually triggers  <br>a few minutes after the actual event                                | - Alert Time: March 21, 15:35<br>- Event Time: March 21, 15:32                                                                   |
| **2** | Alert Name        | Provides a summary of what happened,  <br>based on the detection rule's name                                               | - Unusual Login Location<br>- Email Marked as Phishing<br>- Windows RDP Bruteforce<br>- Potential Data Exfiltration              |
| **3** | Alert Severity    | Defines the urgency of the alert,  <br>initially set by detection engineers,  <br>but can be altered by analysts if needed | - (ðŸŸ¢) Low / Informational<br>- (ðŸŸ¡) Medium / Moderate<br>- (ðŸŸ ) High / Severe<br>- (ðŸ”´) Critical / Urgent                       |
| **4** | Alert Status      | Informs if somebody is working on the alert  <br>or if the triage is done                                                  | - (ðŸ†•) New / Unassigned<br>- (ðŸ”„) In Progress / Pending<br>- (âœ…) Closed / Resolved<br>- And often other custom statuses          |
| **5** | Alert Verdict     | Also called alert classification,  <br>explains if the alert is a real threat or noise                                     | - (ðŸ”´) True Positive / Real Threat<br>- (ðŸŸ¢) False Positive / No Threat<br>- And often other custom verdicts                     |
| **6** | Alert Assignee    | Shows the analyst that was assigned  <br>or assigned themselves to review the alert                                        | - Assignee can sometimes be called alert owner<br>    <br>- Assignee takes responsibility for their alerts                       |
| **7** | Alert Description | Explains what the alert is about,  <br>usually in three sections on the right                                              | - The logic of the alert generating rule<br>- Why this activity can indicate an attack<br>- Optionally, how to triage this alert |
| **8** | Alert Fields      | Provides SOC analysts' comments  <br>and values on which the alert was triggered                                           | - Affected Hostname<br>- Entered Commandline<br>- And many more, depending on the alert                                          |

Questions:
```
What was the verdict for the "Unusual VPN Login Location" alert?
False Positive

What user was mentioned in the "Unusual VPN Login Location" alert?
M.Clark
```

<img width="1458" height="338" alt="ss2" src="https://github.com/user-attachments/assets/5779b8f1-2d8f-4b4f-ab7e-ae6a2521eb36" />


## Alert Prioritisation

The process of deciding which to take is called **Alert Prioritisation**, and it is crucial to ensure timely detection of a threat, especially with many alerts in the queue.

### Picking the Right Alert

Every SOC team decides on its own prioritisation rules and usually automates them by setting the appropriate alert sorting logic in SIEM or EDR. Below, you may see the generic, simplest, and most commonly used approach:

1. **Filter the alerts**  
    Make sure you don't take the alert that other analysts have already reviewed, or that is already being investigated by one of your teammates. You should only take new, yet unseen and unresolved alerts.
2. **Sort by severity**  
    Start with critical alerts, then high, medium, and finally low. This is because detection engineers design rules so that critical alerts are much more likely to be real, major threats and cause much more impact than medium or low ones.
3. **Sort by time**  
    Start with the oldest alerts and end with the newest ones. The idea is that if both alerts are about two breaches, the hacker from the older breach is likely already dumping your data, while the "newcomer" has just started the discovery.

Questions:
```
Should you first prioritise medium over low severity alerts? (Yea/Nay)
Yea

Should you first take the newest alerts and then the older ones? (Yea/Nay)
Nay

Assign yourself to the first-priority alert and change its status to In Progress.
The name of your selected alert will be the answer to the question.
Potential Data Exfiltration
```

<img width="667" height="455" alt="ss3" src="https://github.com/user-attachments/assets/da2627c1-9269-48ce-ba00-c6adb5440f9c" />


## Alert Triage

Note that the alert review by SOC analysts can also be called alert triage, alert handling, alert processing, alert investigation, or alert analysis

<img width="1211" height="451" alt="ss4" src="https://github.com/user-attachments/assets/6580b971-f7da-4158-8127-2ceb7e1659eb" />

### Initial Actions

The initial steps are designed to ensure that you take ownership of the assigned alert and avoid interfering with alerts being handled by other analysts, and confirm that you are fully prepared to proceed with the detailed investigation. You achieve it by first assigning the alert to yourself, moving it to **In Progress**, and then familiarising yourself with the alert details like its name, description, and key indicators.

### Investigation

This is the most complex step, requiring you to apply your technical knowledge and experience to understand the activity and properly analyse its legitimacy in SIEM or EDR logs. To support L1 analysts with this step, some teams develop **Workbooks** (also known as playbooks or runbooks) - instructions on how to investigate the specific category of alerts. If workbooks are not available, below are some key recommendations:

1. Understand who is under threat, like the affected user, hostname, cloud, network, or website
2. Note the action described in the alert, like whether it was a suspicious login, malware, or phishing
3. Review surrounding events, looking for suspicious actions shortly after or before the alert
4. Use threat intelligence platforms or other available resources to verify your thoughts

### Final Actions

Your decisions here determine whether you found or missed the potential cyberattack. Some actions like **Escalation** or **Commenting** will be explained in the following rooms, so don't worry if they sound complex right now. First, decide if the alert you investigated is malicious (True Positive) or not (False Positive). Then, prepare your detailed comment explaining your analysis steps and verdict reasoning, return to the dashboard and move it to theÂ **Closed** status.

Questions:
```
Which flag did you receive after you correctly triaged the first-priority alert?
THM{looks_like_lots_of_zoom_meetings}
```

Logic: The rule detects 5 or more gigabytes of data sent from a single device to a single destination within a day, which may indicate data exfiltration to untrusted location.

We can infer from the zoom meeting information and private IP, that the data was not maliciously exfiltrated as the rule originally alerted to.

<img width="670" height="453" alt="ss11" src="https://github.com/user-attachments/assets/9c371973-69c5-4211-bb11-dab7dea6e14e" />


```
Which flag did you receive after you correctly triaged the second-priority alert?
THM{how_could_this_user_fall_for_it?}
```

Moving onto the High severity alert, we can see the rule description indicating:
"This rule detects a creation of a double-extension file like '*.pdf.exe' or '*.gif.lnk', often used by hackers in phishing attacks to trick users into opening the malicious executable."

<img width="1465" height="360" alt="ss7" src="https://github.com/user-attachments/assets/58f5a2cf-b235-4c5a-97df-8dd47de34608" />


The target file, `cats2025.mp4.exe` indicates double-extension file creation. We can move forward with declaring this alert as a true positive that warrants further investigation.

<img width="670" height="456" alt="ss8" src="https://github.com/user-attachments/assets/5c79ee64-8c60-4f72-ac91-f8a42b171f16" />


```
Which flag did you receive after you correctly triaged the third-priority alert?
THM{should_we_allow_github_for_devs?}
```

Our final event has a Low severity rating, with the following rule description:
"This rule detects any download from GitHub. While GitHub stores lots of great projects that our IT team uses, it also stores malicious scripts and exploits that must not be downloaded by the users."

<img width="1468" height="292" alt="ss9" src="https://github.com/user-attachments/assets/0f5533f3-fb69-4251-8662-ece9fb84b8a3" />


Considering the source user, host, and network all seem to be internal, we can safely assume that one of our developers initiated the download as something they required for their tasks.

We can take this further by consulting company policy and contrasting the accessed URL with known allowed resources if specified.

<img width="668" height="458" alt="ss10" src="https://github.com/user-attachments/assets/2e04aa10-744d-437f-a2b5-f8001340f92e" />
